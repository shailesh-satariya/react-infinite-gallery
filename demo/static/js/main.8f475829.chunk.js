(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{18:function(e,t,n){},19:function(e,t,n){},20:function(e,t,n){},22:function(e,t,n){},23:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(5),o=n.n(c),s=n(7),i=n(3),u=n(2),l=n(10),d=n(1),f="APPEND_PHOTOS",j="SET_PHOTOS",h=[],b=r.a.createContext(null),p=function(){var e=r.a.useContext(b);if(!e)throw new Error("usePhotos must be used within a PhotosProvider");return e},O=function(e){var t=r.a.useReducer((function(e,t){switch(t.type){case j:return t.payload;case f:return[].concat(Object(l.a)(e),Object(l.a)(t.payload));default:throw e}}),h),n=Object(u.a)(t,2),a=n[0],c=n[1],o=r.a.useMemo((function(){return[a,c]}),[a,c]);return Object(d.jsx)(b.Provider,Object(i.a)({value:o},e))},m=n(9),v=n.n(m),g=n(11),x="liked-photos",S=JSON.parse(localStorage.getItem(x)||"[]"),y=function(e,t){var n=function(e,t){try{var n=new URL(e);for(var a in t)n.searchParams.append(a,t[a].toString());return n.href}catch(r){return!1}}("https://picsum.photos/v2/list",{page:e,limit:t});return!1===n?Promise.reject("Invalid url!"):fetch(n)},E={PAGE_SIZE:30},P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=r.a.useState(null),c=Object(u.a)(a,2),o=c[0],s=c[1],l=r.a.useState(!1),d=Object(u.a)(l,2),f=d[0],j=d[1],h=r.a.useRef(null),b=function(){h.current&&h.current.disconnect()};return r.a.useEffect((function(){s(e.current)}),[e]),r.a.useEffect((function(){if(o)return b(),(h.current=new IntersectionObserver((function(e){var t=Object(u.a)(e,1)[0].isIntersecting;n?n&&!f&&t&&(j(t),b()):j(t)}),Object(i.a)({},t))).observe(o),function(){b()}}),[o,t]),f},w=function(e){var t=e.children,n=e.hasMore,a=e.loadMore,c=e.loader,o=e.attributes,s=r.a.useState(!1),l=Object(u.a)(s,2),f=l[0],j=l[1];r.a.useEffect((function(){return j(!1)}),[t,j]);var h=r.a.useRef(null),b=P(h,{threshold:0},!1);return r.a.useEffect((function(){b&&n&&!f&&(a(),j(!0))}),[b,n]),Object(d.jsxs)("div",Object(i.a)(Object(i.a)({"data-test":"component-infinite-scroll"},o),{},{children:[t,f&&c?Object(d.jsx)("div",{"data-test":"element-loader",children:c}):null,Object(d.jsx)("div",{ref:h,style:{height:"1px",marginTop:"-1px"},"data-test":"element-last"})]}))},N=(n(18),function(e){var t=e.photo,n=r.a.useRef(null),a=P(n,{threshold:0},!1),c=r.a.useState(function(e){return S.indexOf(e.id)>-1}(t)),o=Object(u.a)(c,2),s=o[0],i=o[1],l=r.a.useState(a),f=Object(u.a)(l,2),j=f[0],h=f[1];r.a.useEffect((function(){a&&h(!0)}),[a,h]);return Object(d.jsxs)("div",{ref:n,className:"gallery-img-wrapper","data-test":"component-gallery-image",children:[j?Object(d.jsx)("img",{src:"".concat("https://picsum.photos/id","/").concat(t.id,"/300"),alt:t.author,className:"gallery-img","data-test":"element-img"}):null,Object(d.jsx)("div",{className:"gallery-img-overlay",children:Object(d.jsxs)("div",{className:"gallery-img-overlay-content",children:[Object(d.jsx)("div",{className:"photo-name","data-test":"element-photo-name",children:t.author}),Object(d.jsx)("div",{className:"photo-author","data-test":"element-photo-author",children:t.author}),Object(d.jsx)("button",{className:"photo-like-button"+(s?" liked":""),onClick:function(){i(!s),function(e){var t=S.indexOf(e.id);t>-1?S.splice(t,1):S.push(e.id),localStorage.setItem(x,JSON.stringify(S))}(t)},"data-test":"button-like",children:"Favourite"})]})})]})}),k=(n(19),function(){return Object(d.jsx)("div",{"data-test":"component-loader"})}),I=(n(20),E.PAGE_SIZE),C=function(){var e=p(),t=Object(u.a)(e,2),n=t[0],a=t[1],c=r.a.useState(1),o=Object(u.a)(c,2),i=o[0],l=o[1],j=r.a.useState(n.length===I),h=Object(u.a)(j,2),b=h[0],O=h[1];r.a.useEffect((function(){Object(g.a)(v.a.mark((function e(){var t,n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y(i,I);case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,a({type:f,payload:n}),O(n.length===I),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),s.b.error(e.t0.toString(),{position:"bottom-right"});case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()}),[i,a,O]);var m=r.a.useCallback((function(){l(i+1)}),[i]),x=Object(d.jsx)(k,{});return Object(d.jsx)(w,{hasMore:b,loadMore:m,loader:x,"data-test":"element-infinite-scroll",children:Object(d.jsx)("div",{className:"gallery-grid",children:n.map((function(e){return Object(d.jsx)(N,{photo:e,"data-test":"element-gallery-image"},e.id)}))})})},M=(n(21),function(){return Object(d.jsxs)("div",{"data-test":"component-app",children:[Object(d.jsx)(O,{children:Object(d.jsx)(C,{"data-test":"element-gallery"})}),Object(d.jsx)(s.a,{"data-test":"element-toast-container"})]})}),T=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,24)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),c(e),o(e)}))};n(22);o.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(M,{})}),document.getElementById("root")),T()}},[[23,1,2]]]);
//# sourceMappingURL=main.8f475829.chunk.js.map